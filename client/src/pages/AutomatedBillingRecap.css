/* re-use your existing patterns (pill controls, instruction card, overlay) */

.recap .select-bar {
  margin-top: 0.25rem;
}

/* ---- Tabs ---- */
.tab-switch {
  display: inline-flex;
  gap: 0.25rem;
  margin-bottom: 0.75rem;
}

.tab-btn {
  appearance: none;
  border: 1px solid rgba(6, 57, 65, 0.25); /* brand deep teal outline */
  background: #fff;
  color: #063941;
  padding: 0.4rem 0.9rem;
  border-radius: 999px;
  font: inherit;
  cursor: pointer;
  transition: box-shadow 120ms ease, background 120ms ease, color 120ms ease;
}

.tab-btn:hover {
  box-shadow: 0 1px 6px rgba(0, 0, 0, 0.12);
}

.tab-btn.active {
  background: linear-gradient(180deg, #e6f6f3, #d2eee9); /* mint family you use elsewhere */
  border-color: #49A050; /* light green edge accent */
  color: #063941;
  font-weight: 600;
}

/* ---- KPI row ---- */
.kpi-row {
  display: grid;
  grid-template-columns: repeat(4, minmax(180px, 1fr));
  gap: 0.75rem;
  margin-bottom: 0.5rem;
}

.kpi-card {
  background: #fff;
  border-radius: 0.75rem;
  border: 1px solid rgba(6, 57, 65, 0.14); /* brand-tinted border */
  box-shadow: 0 1px 8px rgba(6, 57, 65, 0.06);
  padding: 0.8rem 1rem;
  position: relative;
}

.kpi-card::before {
  /* thin green accent on the left, like your example screenshot */
  content: "";
  position: absolute;
  left: 0;
  top: 0;
  bottom: 0;
  width: 6px;
  border-radius: 0.75rem 0 0 0.75rem;
  background: #4f46e5bf; 
}

.kpi-title {
  font-size: 0.72rem;
  letter-spacing: 0.02em;
  text-transform: uppercase;
  color: #6b7280; /* cool gray */
  margin-bottom: 0.25rem;
}

.kpi-value {
  font-size: 1.15rem;
  font-weight: 700;
  color: #0b2a30; /* deep ink */
}

/* ---- Controls ---- */
.recap-controls .pill-select {
  min-width: 14rem;
}

/* ---- Context chips over table ---- */
.context-bar {
  display: flex;
  gap: 0.5rem;
  align-items: center;
  margin: 0.25rem 0 0.5rem 0;
  flex-wrap: wrap;
}

.context-bar .chip {
  background: #f3f9f8;
  border: 1px solid rgba(6, 57, 65, 0.14);
  color: #063941;
  padding: 0.25rem 0.6rem;
  border-radius: 999px;
  font-size: 0.85rem;
}

.context-bar .chip .chip-label {
  opacity: 0.75;
  margin-right: 0.25rem;
}

/* ---- number alignment in table ---- */
.recap .num:not(th):not(td) {
  display: inline-block;
  min-width: 6ch;
  text-align: right;
}

/* Let table cells that carry .num stay table-cells */
.recap table th.num,
.recap table td.num {
  display: table-cell;
  min-width: 0;          /* undo 6ch inside tables */
  text-align: right;     /* keep the alignment */
}

/* loader overlay reuse */
.loader-overlay {
  position: fixed;
  inset: 0;
  background: rgba(255, 255, 255, 0.55);
  backdrop-filter: blur(2px);
  z-index: 1000;
}

.recap-namefilter { min-width: 16rem; }

/* pill-style button to match selects/inputs */
.pill-btn {
  padding: 0.5rem 0.9rem;
  border: 1px solid #d1d5db;
  border-radius: 999px;
  background: #fff;
  font: inherit;
  cursor: pointer;
  transition: box-shadow 120ms ease, background 120ms ease, border-color 120ms ease;
}

.pill-btn:hover {
  box-shadow: 0 1px 6px rgba(0, 0, 0, 0.12);
}

/* brand accent for the clear button */
.clear-filter-btn {
  border-color: #49A050;      /* BMSS green accent */
  color: #063941;             /* deep teal text */
}

/* widen partner/manager pickers a bit */
.recap-namefilter { min-width: 16rem; }

/* nice spacing for clear buttons */
.clear-filter-btn { margin-left: 0.25rem; }

/* Viz card on the right */
.nb-viz-card {
  background: #fff;
  border-radius: 0.75rem;
  border: 1px solid rgba(6, 57, 65, 0.14);
  box-shadow: 0 1px 8px rgba(6, 57, 65, 0.06);
  padding: 1rem 1.1rem;
  height: 100%;
  display: flex;
  flex-direction: column;
}

.nb-viz-title {
  font-size: 0.95rem;
  font-weight: 600;
  color: #0b2a30;
  margin-bottom: 0.6rem;
}

.nb-viz-bars {
  display: flex;
  flex-direction: column;
  gap: 0.6rem;
}

/* each row: label (fixed) | bar (fills) */
.nb-viz-row {
  display: grid;
  grid-template-columns: 12rem 1fr; /* give labels breathing room */
  gap: 0.6rem;
  align-items: center;
}

.nb-viz-label {
  font-size: 0.9rem;
  color: #063941;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.nb-viz-bar {
  position: relative;
  height: 32px;                       /* taller bars */
  border-radius: 999px;
  background: #eef5f7;
  overflow: hidden;
  border: 1px solid rgba(6, 57, 65, 0.12);
}

.nb-viz-fill {
  height: 100%;
  /* brand blue gradient */
  background: linear-gradient(90deg, #3b82f6, #1e40af);
  border-radius: 999px;
  transition: width 220ms ease;
}

.nb-viz-value {
  position: absolute;
  right: 10px;
  top: 50%;
  transform: translateY(-50%);
  font-size: 0.9rem;
  color: #ffffff;
  text-shadow: 0 1px 2px rgba(0,0,0,0.35);
  pointer-events: none;
}


/* Push "Clear Filters" to the right in the context bar */
.context-bar .spacer {
  flex: 1;
}

/* Two fixed columns: left = controls + KPIs + chips (anchored),
   right = wide viz */
.nb-row {
  display: grid;
  grid-template-columns: 1fr 1fr; /* left half | right half */
  gap: 1rem;
  align-items: start;
  margin-bottom: 0.75rem;
}

/* Left column stacks its sections with consistent spacing */
.nb-left {
  display: flex;
  flex-direction: column;
  gap: 0.75rem;
}

/* Keep KPIs exactly two across (same sizing as before) */
.nb-left .kpi-row {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 0.75rem;
  margin: 0;
}

/* Viz card fills the right column */
.nb-viz-card {
  background: #fff;
  border-radius: 0.75rem;
  border: 1px solid rgba(6, 57, 65, 0.14);
  box-shadow: 0 1px 8px rgba(6, 57, 65, 0.06);
  padding: 1rem 1.1rem;
  height: auto;
  align-self: start;
  display: flex;
  flex-direction: column;
}

.nb-viz-title {
  font-size: 0.95rem;
  font-weight: 600;
  color: #0b2a30;
  margin-bottom: 0.6rem;
}

.nb-viz-bars { display: flex; flex-direction: column; gap: 0.6rem; }

/* label | bar */
.nb-viz-row {
  display: grid;
  grid-template-columns: 12rem 1fr;
  gap: 0.6rem;
  align-items: center;
}
.nb-viz-label { font-size: 0.9rem; color: #063941; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }

.nb-viz-bar {
  position: relative;
  height: 32px;
  border-radius: 999px;
  background: #eef5f7;
  overflow: hidden;
  border: 1px solid rgba(6, 57, 65, 0.12);
}
.nb-viz-fill {
  height: 100%;
  background: linear-gradient(90deg, #063941, #547872); /* brand blue gradient */
  border-radius: 999px;
  transition: width 220ms ease;
}
.nb-viz-value {
  position: absolute;
  right: 10px;
  top: 50%;
  transform: translateY(-50%);
  font-size: 0.9rem;
  color: #fff;
  text-shadow: 0 1px 2px rgba(0,0,0,0.35);
  pointer-events: none;
}

/* keep Clear Filters to right edge of chip row */
.context-bar .spacer { flex: 1; }

/* Align the viz card to the top of the filter dropdown row */
:root {
  /* Tweak this to match your filter row height (48–64px usually).
     56px tends to line up well with pill dropdowns. */
  --nb-align-to-filters: 56px;
}

/* Two fixed columns remain */
.nb-row {
  display: grid;
  grid-template-columns: 1fr 1fr; /* left half | right half */
  gap: 1rem;
  align-items: start;
  margin-bottom: 0.75rem;
}

/* Left column: no artificial offset now */
.nb-left {
  display: flex;
  flex-direction: column;
  gap: 0.75rem;
  margin-top: 0; /* keep KPIs naturally below the filters */
}

/* Viz card: pull up to align with the filter dropdowns */
.nb-viz-card {
  background: #fff;
  border-radius: 0.75rem;
  border: 1px solid rgba(6, 57, 65, 0.14);
  box-shadow: 0 1px 8px rgba(6, 57, 65, 0.06);
  padding: 1rem 1.1rem;
  height: auto;        /* ensure no stretching */
  align-self: start;   /* don’t grow with the row */
  margin-top: calc(var(--nb-align-to-filters) * -1);
}

/* Keep KPIs two-across, unchanged size */
.nb-left .kpi-row {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 0.75rem;
  margin: 0;
}

/* Tighten spacing so “Bill Through” chip hugs the table */
.nb-left .select-bar { margin-bottom: 0.25rem; }
.nb-left .kpi-row    { margin-bottom: 0.25rem; }
.context-bar         { margin-top: 0.25rem; margin-bottom: 0.25rem; }
.table-section       { margin-top: 0.5rem; }

/* —— Viz internals with PURPLE bars —— */
.nb-viz-title {
  font-size: 0.95rem;
  font-weight: 600;
  color: #0b2a30;
  margin-bottom: 0.6rem;
}
.nb-viz-bars { display: flex; flex-direction: column; gap: 0.6rem; }

.nb-viz-row {
  display: grid;
  grid-template-columns: 12rem 1fr; /* label | bar */
  gap: 0.6rem;
  align-items: center;
}
.nb-viz-label {
  font-size: 0.9rem;
  color: #063941;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.nb-viz-bar {
  position: relative;
  height: 32px;
  border-radius: 999px;
  background: #eef1ff; /* slightly purple track to match the brand */
  overflow: hidden;
  border: 1px solid rgba(79, 70, 229, 0.18); /* purple-ish border */
}

.nb-viz-fill {
  height: 100%;
  /* Purple gradient “pop” using your color */
  background: linear-gradient(90deg, rgba(167, 139, 250, 0.95), #4f46e5bf);
  border-radius: 999px;
  box-shadow: inset 0 0 0 1px rgba(255,255,255,0.25),
              0 2px 6px rgba(79, 70, 229, 0.25);
  transition: width 220ms ease;
}

.nb-viz-value {
  position: absolute;
  right: 10px;
  top: 50%;
  transform: translateY(-50%);
  font-size: 0.9rem;
  color: #fff;
  text-shadow: 0 1px 2px rgba(0,0,0,0.35);
  pointer-events: none;
}

/* Responsive safety: on narrow screens, don’t pull the viz into the header */
@media (max-width: 1100px) {
  :root { --nb-align-to-filters: 0px; }
  .nb-row { grid-template-columns: 1fr; }
  .nb-viz-card { margin-top: 0; }
}

.nb-viz-fill { min-width: 6px; }

/* ===== Practice Engine circular link button ===== */
.pe-link-btn{
  display:inline-grid;
  place-items:center;
  width:36px; height:36px;
  border-radius:50%;
  border:1px solid #d7dee5;
  background:
    radial-gradient(120% 120% at 30% 20%, rgba(255,255,255,.85) 0%, rgba(255,255,255,.25) 35%, rgba(255,255,255,0) 60%),
    linear-gradient(135deg, #f1f4f7, #e3e8ee);
  box-shadow:
    0 1px 0 rgba(0,0,0,.02),
    0 4px 10px rgba(0,0,0,.08),
    inset 0 2px 4px rgba(255,255,255,.6);
  transition: transform .08s ease, box-shadow .15s ease, filter .15s ease;
}

.pe-link-btn:hover{
  box-shadow:
    0 2px 12px rgba(0,0,0,.16),
    inset 0 2px 6px rgba(255,255,255,.7);
  filter: saturate(1.05);
}

.pe-link-btn:active{
  transform: translateY(1px);
  box-shadow:
    0 1px 6px rgba(0,0,0,.12) inset,
    0 0 0 rgba(0,0,0,0);
}

.pe-logo{
  width:20px; height:20px; display:block;
  filter: drop-shadow(0 1px 1px rgba(0,0,0,.15));
}

/* Shorter KPI tiles */
.kpi-row {
  gap: 14px;
}
.kpi-card {
  min-height: 64px;              /* was taller – now compact */
  padding: 10px 14px;
}
.kpi-title {
  font-size: 11px;
  letter-spacing: .02em;
  opacity: .7;
}
.rotkpi-value, .kpi-value {
  font-size: 20px;               /* was larger – trimmed */
  line-height: 1.2;
}

/* Exclude drafts checkbox */
.exclude-drafts {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  margin-left: 10px;
  padding: 6px 10px;
  border-radius: 999px;
  background: #f5f7fb;
  border: 1px solid #e3e8ef;
  white-space: nowrap;
}
.exclude-drafts input[type="checkbox"] {
  width: 16px; height: 16px;
}
.exclude-drafts.on {
  background: #eef3ff;
  border-color: #d6e0ff;
}
.exclude-drafts .mini-spinner {
  width: 14px; height: 14px;
  border-radius: 50%;
  border: 2px solid rgba(0,0,0,.15);
  border-top-color: rgba(0,0,0,.4);
  animation: spin .75s linear infinite;
}
@keyframes spin {
  to { transform: rotate(360deg); }
}

/* ----- KPI compact variant (Not Billed only) ----- */
.kpi-row--compact {
  gap: 12px;              /* tighter spacing between cards */
  margin: 6px 0 8px;      /* small bottom margin to fit checkbox */
}

.kpi-row--compact .kpi-card {
  padding: 8px 12px;      /* was ~16-20px on your base style */
  min-height: 56px;       /* was ~88-112px; keep it short */
}

.kpi-row--compact .kpi-title {
  font-size: 12px;        /* down from 13-14 */
  line-height: 1.1;
  opacity: 0.85;
}

.kpi-row--compact .kpi-value {
  font-size: 22px;        /* down from ~28-32 */
  line-height: 1.1;
}

/* ensure the right viz doesn't overlap; align to top */
.nb-row {
  display: grid;
  grid-template-columns: 1fr 1fr;   /* you already have a two-col feel; keep even */
  gap: 16px;
  align-items: start;               /* <-- important: no vertical stretching/overlap */
}

/* checkbox pill that sits under the KPI cards */
.nb-inline-option {
  margin: 2px 0 10px;               /* tiny gap below KPIs, above chips */
}

.checkbox-pill {
  display: inline-flex;
  align-items: center;
  gap: 10px;
  padding: 6px 12px;
  border-radius: 999px;
  border: 1px solid var(--line, #e6e6ea);
  background: linear-gradient(#fff, #fafbff);
  box-shadow: 0 1px 0 rgba(0,0,0,.04);
  font-size: 14px;
  white-space: nowrap;
}

.checkbox-pill input {
  width: 16px;
  height: 16px;
}

.checkbox-pill input[type="checkbox"] {
  accent-color: #4f46e5bf;
}

/* Make negative deltas read clearly (optional) */
.recap .table-section .num {
  font-variant-numeric: tabular-nums;
}
.recap .table-section .num:has(+ .delta-neg),
.recap .table-section .delta-neg {
  color: #b91c1c; /* red-700 */
}

/* Optional: subtle badge look for the third tab when active is already defined */
.tab-btn.active {
  /* you already style .active; this ensures consistency if theme differs */
  background: linear-gradient(180deg, #e6f6f3, #d2eee9);
  border-color: #49A050;
  font-weight: 600;
}

/* Split KPI (Draft | Actual | Δ) */
.kpi-split .kpi-split-grid {
  display: grid;
  grid-template-columns: repeat(3, minmax(0, 1fr));
  gap: 10px;
  align-items: end;
  margin-top: 6px;
}

.kpi-mini-label {
  font-size: 11px;
  opacity: .75;
  letter-spacing: .01em;
  margin-bottom: 2px;
}

.kpi-mini-value {
  font-size: 18px;
  font-weight: 700;
  line-height: 1.1;
  color: #0b2a30;
}

.kpi-mini--delta .kpi-mini-value {
  display: inline-block;
}

.kpi-delta-badge {
  display: inline-block;
  padding: 2px 8px;
  border-radius: 999px;
  border: 1px solid rgba(6,57,65,0.14);
  background: #f7fafe;
}

.kpi-delta-badge.pos {
  background: #eaf9f0;
  border-color: rgba(73,160,80,0.35);
}

.kpi-delta-badge.neg {
  background: #fff1f1;
  border-color: rgba(220,38,38,0.3);
}

/* Rotating KPI (Draft -> Actual -> Δ) */
.rotkpi { position: relative; overflow: hidden; }
.rotkpi .rotkpi-stagewrap {
  position: relative;
  min-height: 44px;         /* keeps card steady while text swaps */
}
.rotkpi-stage {
  position: absolute;
  inset: 0;
  opacity: 0;
  transform: translateY(6px);
  transition: opacity 320ms ease, transform 320ms ease;
  display: grid;
  align-content: start;
  gap: 4px;
}
.rotkpi-stage.is-active {
  opacity: 1;
  transform: translateY(0);
}
.rotkpi-label {
  font-size: 11px;
  letter-spacing: .02em;
  color: #6b7280;
}
.rotkpi-value {
  font-size: 20px;
  font-weight: 700;
  color: #0b2a30;
  line-height: 1.1;
}
.rotkpi-value.pos { color: #166534; }  /* green-ish for positive Δ */
.rotkpi-value.neg { color: #b91c1c; }  /* red-ish for negative Δ */

/* header row in KPI: title left, sublabel right */
.kpi-title-row {
  display: flex;
  align-items: baseline;
  justify-content: space-between;
  gap: 8px;
}

.kpi-sub {
  font-size: 12px;
  font-weight: 600;
  opacity: 0.8;
  padding: 2px 8px;
  border-radius: 999px;
  border: 1px solid transparent;
  transition: opacity 200ms ease, transform 200ms ease;
}

/* subtle badge tone; Δ gets green/red border with the pos/neg classes already in use */
.kpi-sub.pos { border-color: rgba(16, 185, 129, .35); }
.kpi-sub.neg { border-color: rgba(239, 68, 68, .35); }

/* keep your existing rotating fade for values; if you don't have it, this will do */
.rotkpi-stagewrap {
  position: relative;
  height: 2.2em; /* keeps card height stable */
}
.rotkpi-stage {
  position: absolute;
  inset: 0;
  opacity: 0;
  transform: translateY(6px);
  transition: opacity 240ms ease, transform 240ms ease;
}
.rotkpi-stage.is-active {
  opacity: 1;
  transform: translateY(0);
}

/* Make non-rotating and rotating KPIs identical */
.kpi-value,
.rotkpi-value {
  font-size: 20px;
  line-height: 1.2;
  font-weight: 700;
  color: #0b2a30;
}

